/**
 * ONF-NFB Menu Minified Behavior jQuery script
 * 
 * @author: DeuxHuitHuit
 * 
 * @version: 1.0
 * 
 * Compiled with YUI 2.4.7 http://www.refresh-sf.com/yui/
 * 
**/
(function(E,l){if(!window.console){window.console={};window.console.log=window.console.warn=window.console.error=window.console.info=E.noop}if(!Array.prototype.forEach){Array.prototype.forEach=function(X){var W=this.length,Z=arguments[1];if(typeof X!="function"){throw new TypeError("First parameter must be a function")}for(var Y=0;Y<W;Y++){if(Y in this){X.call(Z,this[Y],Y,this)}}}}var y=r(E("html").attr("lang"),"en"),s=(y=="fr"?"http://www.onf.ca":"http://www.nbf.ca"),V="http://search.nfb.ca/search?entqr=0&output=xml_no_dtd&sort=date%3AD%3AL%3Ad1&client=beta_onfb&ud=1&oe=UTF-8&ie=UTF-8&proxystylesheet=beta_onfb&proxyreload=1&hl="+y+"&lr=lang_"+y+"&site=beta_onfb&q=",L=55,I="onf-nfb",h="topclick.onf-nfb",S="help.onf-nfb",C="lang.onf-nfb",o="search.onf-nfb",P="botclick.onf-nfb",Q="share.onf-nfb",k="volume.onf-nfb",G="fullscreen.onf-nfb",B=[],t={target:"#onf-top",opacity:0.8,opacityHover:1,recursive:false,ready:null,links:[{title:{fr:"Explorer",en:"Explore"},url:{fr:"http://www.onf.ca/explorer-tous-les-films/",en:"http://www.nfb.ca/explore-all-films/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"explore"},{title:{fr:"Sélections",en:"Playlists"},url:{fr:"http://onf.ca/selections/",en:"http://www.nfb.ca/playlists/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"playlist"},{title:{fr:"Chaînes",en:"Channels"},url:{fr:"http://www.onf.ca/chaines/",en:"http://www.nfb.ca/channels/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"channels"},{title:{fr:"Blogue",en:"Blog"},url:{fr:"http://blogue.onf.ca/",en:"http://blog.nfb.ca/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"blog"},{title:{fr:"Interactif",en:"Interactive"},url:{fr:"http://www.onf.ca/interactif/",en:"http://www.nfb.ca/interactive/"},callback:null,preventDefault:false,target:null,cssClass:"active",tag:"interative"}],search:{title:{fr:"Recherche",en:"Search"},callback:null},help:{title:{fr:"Aide",en:"Help"},url:{fr:"http://www.onf.ca/a-propos/faq/",en:"http://www.nfb.ca/about/faq/"},callback:null,preventDefault:false,target:"_blank",cssClass:null,tag:"help"},translate:[{title:"Français",url:"http://interactif.onf.ca/",callback:null,preventDefault:false,target:null,cssClass:null,tag:"lang-fr"},{title:"English",url:"http://interactive.nfb.ca/",callback:null,preventDefault:false,target:null,cssClass:null,tag:"lang-en"}]},z={target:"#onf-bot",opacity:0.8,opacityHover:1,recursive:false,ready:null,links:[{title:{fr:"Accueil",en:"Home"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"home"},{title:{fr:"À propos",en:"About"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"about"},{title:{fr:"Films reliés",en:"Related movies"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"related"},{title:{fr:"Équipe",en:"Credits"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont",tag:"credits"}],share:{title:{fr:"Partagez",en:"Share"},links:{facebook:"http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(document.location),twitter:"https://twitter.com/intent/tweet?text="+encodeURIComponent(document.title)+"&url="+encodeURIComponent(document.location),stumpleupon:"http://www.stumbleupon.com/submit?url="+encodeURIComponent(document.location)+"&title="+encodeURIComponent(document.title),digg:"http://digg.com/submit?phase=2&url="+encodeURIComponent(document.location)+"&bodytext="+encodeURIComponent(document.title),delicious:"http://www.delicious.com/post?v=2&url="+encodeURIComponent(document.location)+"&title="+encodeURIComponent(document.title)},callback:null},volume:{title:{fr:"Volume",en:"Volume"},callback:null},fullscreen:{title:{fr:"Plein écran",en:"Fullscreen"},callback:null}};function g(W){return E.isFunction(W)?W.call(this,y):W}function c(W){return E.isPlainObject(W)?W[y]:g(W)}function r(X,W){return !!X?X:W}function H(W){if(!!W&&E.isFunction(W.preventDefault)){W.preventDefault()}return false}function n(ad){var Y=E(this),ab=Y.data("link"),aa=Y.data("event"),ac=Y.data("target"),W=ab.tag||Y.attr("data-tag"),Z=ac.data("opts"),X=true;if(!!ab){if(E.isFunction(ab.callback)){ab.callback.call(Y,ad,Y,Z,W)}if(!!ab.preventDefault){X=H(ad)}}ac.triggerHandler(aa,[ad,Y,Z,W]);E.onf_nfb.stats.log("menu","click",W,Y.index());return X}function p(aa,Y){var W=E(this),X=W.data("opts"),Z=g(X.opacity);if(Y){Z=g(X.opacityHover)}W.stop(true,false).animate({opacity:Z},250)}function U(W){p.call(this,W,true)}function v(W){p.call(this,W,false)}function b(X,Z,Y){var W=E("<a></a>");W.text(c(X.title));if(!!X.url){W.attr("href",c(X.url))}else{W.attr("href","#")}W.data("link",X);W.data("target",Z);W.data("event",Y);if(!!X.target){W.attr("target",g(X.target))}if(!!X.cssClass){W.attr("class",c(X.cssClass))}W.click(n);return W}function D(){return document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.webkitFullScreen||document.msFullScreen}function N(W){if(D()){return R(W)}return M(W)}function d(){var W=document.documentElement,X=W.requestFullScreen||W.webkitRequestFullScreen||W.webkitEnterFullScreen||W.mozRequestFullScreen||W.msRequestFullScreen;return X}function M(X){var W=d(),Y=false;if(W!=l&&E.isFunction(W)){W.call(document.documentElement);Y=true}if(Y){E.event.trigger(G,[X,this,true]);E.onf_nfb.stats.log("menu","fullscreen",true)}return H(X)}function R(Y){var Z=false,X=document,W=X.exitFullScreen||X.cancelFullScreen||X.webkitExitFullScreen||X.webkitCancelFullScreen||X.mozExitFullScreen||X.mozCancelFullScreen||X.msExitFullScreen||X.msExitCancelScreen;if(W!=l&&E.isFunction(W)){W.call(X);Z=true}if(Z){E.event.trigger(G,[Y,this,false]);E.onf_nfb.stats.log("menu","fullscreen",false)}return H(Y)}function e(){return !!d()}function m(Y){var W=E("#onf-volume"),X=false;W.toggleClass("muted");X=W.hasClass("muted");if(!!E.cookie){E.cookie("muted",X?1:null,{expires:7,path:"/"})}E.event.trigger(k,[Y,W,X]);E.onf_nfb.stats.log("menu","mute",X);return H(Y)}function x(W,Y,X){if(E.isFunction(Y)){if(!!X&&E.isFunction(X.on)){X.on(W,Y)}else{E(document).on(W,Y)}}}function J(W,ac,Z,ab,Y){var X=g(this.minDelay);if(!Y||isNaN(Y)||Y<X){Y=X}function aa(){B.forEach(function(af,ae){try{af.log(W,ac,Z,ab)}catch(ad){console.error("[stats] "+af.name+": "+ad.message)}})}setTimeout(aa,Y)}function w(W){B.push(W)}function A(){var W={name:"ONF-NFB logger",log:function(Y,ab,Z,aa){if(!!window.ntptEventTag&&E.isFunction(ntptEventTag)){var ac=Y+" > "+ab;if(!!Z){ac+=" > "+Z}if(!isNaN(aa)){ac+=" > "+aa}ntptEventTag("ev=interactif&ntpgi_interactive_page="+ac);return true}return false}},X={name:"GA stats logger",log:function(Y,ab,Z,aa){if(!!window._gaq&&E.isFunction(_gaq.push)){_gaq.push(["_trackEvent",Y,ab,Z,aa]);return true}return false}};w(W);w(X)}A();function T(X){var W=E("#onf-top-search-txt").val();if(!!W&&W.length>0){E.event.trigger(o,[X,this,W]);E.onf_nfb.stats.log("menu","search",W);setTimeout(function(){document.location=V+encodeURIComponent(W)},E.onf_nfb.stats.minDelay)}return H(X)}function O(aa,X){var Y=E("#onf-top-search-pnl"),Z=E("#onf-top-search-lbl"),W=Y.find("input[type=text]").eq(0);Y[X?"fadeIn":"fadeOut"].call(Y,400);Z[X?"fadeOut":"fadeIn"].call(Z,400);W[X?"focus":"blur"].call(W);return H(aa)}function K(W){return O.call(this,W,true)}function a(W){return O.call(this,W,false)}function F(W){switch(W.which){case 27:a.call(this);break;case 13:T();break}return true}function i(ah){var X=E.extend((!!ah&&!!ah.recursive?true:{}),X,t,ah),af=E(X.target),ad=Math.abs(g(X.opacity)-g(X.opacityHover))>0,ab=E('<a id="onf-top-logo"></a>'),ac=E('<span id="onf-top-search"></span>'),ae=E('<a href="#" id="onf-top-search-lbl"></a>'),Z=E('<div id="onf-top-search-pnl"></div>'),aa=E('<input id="onf-top-search-txt" type="text" />'),W=E('<input id="onf-top-search-btn" type="button" value="" />'),ag=E('<div id="onf-top-right"></span>'),Y=E('<div id="onf-top-wrap"></div>');if(!af||!af.length){console.error("[top] the target "+X.target+" could not be found.");return}ab.attr("href",s);ab.click(function(ai){E.event.trigger(h,[ai,this,X,"logo"]);E.onf_nfb.stats.log("menu","click","logo");return true});Y.append(ab);if(!!X.links&&!!X.links.length){X.links.forEach(function(aj,ai){Y.append(b(aj,af,h))})}if(!!X.search){ae.text(c(X.search.title));ae.click(K);aa.attr("placeholder",c(X.search.title));aa.keydown(F);W.click(T);Z.append(aa).append(W);ac.append(ae).append(Z);Y.append(ac);E(document.documentElement).mousedown(function(ai){if(ai.target.nodeName!="INPUT"){a(ai)}return true});x(o,X.search.callback)}if(!!X.help){ag.append(b(X.help,af,S))}if(!!X.translate&&!!X.translate.length){X.translate.forEach(function(aj,ai){if(aj.tag!="lang-"+y){ag.append(b(aj,af,C))}})}Y.append(ag);af.empty().append(Y);af.data("opts",X);if(ad){af.hover(U,v);v.call(af)}else{af.off("mouseenter",U).off("mouseleave",v)}if(E.isFunction(X.ready)){X.ready.call(af,X)}}function u(ab,aa){var Z=E("#onf-bot-share"),W=L,Y=Z.find(".onf-social").length,X=W+(20*Y);if(aa){W=X}Z.stop(false,false).animate({width:W},X*2);return H(ab)}function f(W){return u.call(this,W,true)}function q(W){return u.call(this,W,false)}function j(ai){var W=E.extend((!!ai&&!!ai.recursive?true:{}),W,z,ai),ad=E(W.target),aa=Math.abs(g(W.opacity)-g(W.opacityHover))>0,Y=E('<div id="onf-bot-wrap"></div>'),ag=E('<span id="onf-bot-right"></span>'),ae=E('<span id="onf-bot-share"></span>'),ac=E('<span id="onf-share-opts"></span>'),X=E('<a href="#" id="onf-volume"></a>'),af=E('<a href="#" id="onf-fullscreen"></a>');if(!ad||!ad.length){console.error("[bot] the target "+W.target+" could not be found.");return}if(!!W.links&&!!W.links.length){W.links.forEach(function(ak,aj){Y.append(b(ak,ad,P))})}if(!!W.share){ae.append(E("<span>"+c(W.share.title)+"</span>"));for(var ab in W.share.links){if(W.share.links.hasOwnProperty(ab)){var Z=W.share.links[ab],ah=E("<a></a>");ah.attr("href",g(Z));ah.attr("data-tag",ab);ah.attr("id","onf-"+ab);ah.attr("class","onf-social");ah.attr("target","_blank");ah.click(function(aj){E.event.trigger(Q,[aj,this,ab]);E.onf_nfb.stats.log("menu","share",ab);return true});ac.append(ah)}}ae.mouseenter(f);ad.mouseleave(q);ae.append(ac);ag.append(ae);x(Q,W.share.callback,ac)}if(!!W.volume){X.text(c(W.volume.title));X.click(m);if(!!E.cookie&&!!E.cookie("muted")){X.addClass("muted")}ag.append(X);x(k,W.volume.callback,X)}if(!!W.fullscreen&&e()){af.text(c(W.fullscreen.title));af.click(N);ag.append(af);x(G,W.fullscreen.callback,af)}Y.append(ag);ad.empty().append(Y);ad.data("opts",W);if(aa){ad.hover(U,v);v.call(ad)}else{ad.off("mouseenter",U).off("mouseleave",v)}if(E.isFunction(W.ready)){W.ready.call(ad,W)}}E.onf_nfb=E.extend(true,E.onf_nfb,{stats:{minDelay:80,log:J,add:w},menu:{top:i,bot:j},events:{namespace:I,topclick:h,help:S,lang:C,search:o,botclick:P,share:Q,volume:k,fullscreen:G}})})(jQuery);