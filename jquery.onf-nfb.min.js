/**
 * ONF-NFB Menu Minified Behavior jQuery script
 * 
 * @author: DeuxHuitHuit
 * 
 * @version: 1.0
 * 
 * Compiled with YUI 2.4.7 http://www.refresh-sf.com/yui/
 * 
**/
(function(F,l){if(!window.console){window.console={};window.console.log=window.console.warn=window.console.error=window.console.info=F.noop}if(!Array.prototype.forEach){Array.prototype.forEach=function(Z){var Y=this.length,ab=arguments[1];if(typeof Z!="function"){throw new TypeError("First parameter must be a function")}for(var aa=0;aa<Y;aa++){if(aa in this){Z.call(ab,this[aa],aa,this)}}}}var y=r(F("html").attr("lang"),"en"),s=(y=="fr"?"http://www.onf.ca":"http://www.nbf.ca"),X="http://search.nfb.ca/search?entqr=0&output=xml_no_dtd&sort=date%3AD%3AL%3Ad1&client=beta_onfb&ud=1&oe=UTF-8&ie=UTF-8&proxystylesheet=beta_onfb&proxyreload=1&hl="+y+"&lr=lang_"+y+"&site=beta_onfb&q=",M=55,J="onf-nfb",h="topclick.onf-nfb",U="help.onf-nfb",D="lang.onf-nfb",o="search.onf-nfb",R="botclick.onf-nfb",S="share.onf-nfb",k="volume.onf-nfb",H="fullscreen.onf-nfb",O=!!window.navigator&&!!navigator.userAgent?navigator.userAgent:false,C={unsupported:!F.browser||(F.browser.msie&&parseInt(F.browser.version,10)<9),ipad:!!O&&O.match(/iPad/i),iphone:!!O&&(O.match(/iPhone/i))||(O.match(/iPod/i)),ios:this.ipad||this.iphone,android:!!O&&(O.match(/Android/i)),mobile:this.ios||this.android||(!!O&&(O.match(/mobile/i)||O.match(/phone/i)))||!!document.location.toString().match(/.+(\?|#)mobile$/i)},B=[],t={target:"#onf-top",opacity:0.8,opacityHover:1,recursive:false,ready:null,links:[{title:{fr:"Explorer",en:"Explore"},url:{fr:"http://www.onf.ca/explorer-tous-les-films/",en:"http://www.nfb.ca/explore-all-films/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"explore"},{title:{fr:"Sélections",en:"Playlists"},url:{fr:"http://onf.ca/selections/",en:"http://www.nfb.ca/playlists/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"playlist"},{title:{fr:"Chaînes",en:"Channels"},url:{fr:"http://www.onf.ca/chaines/",en:"http://www.nfb.ca/channels/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"channels"},{title:{fr:"Blogue",en:"Blog"},url:{fr:"http://blogue.onf.ca/",en:"http://blog.nfb.ca/"},callback:null,preventDefault:false,target:null,cssClass:null,tag:"blog"},{title:{fr:"Interactif",en:"Interactive"},url:{fr:"http://www.onf.ca/interactif/",en:"http://www.nfb.ca/interactive/"},callback:null,preventDefault:false,target:null,cssClass:"active",tag:"interative"}],search:{title:{fr:"Recherche",en:"Search"},callback:null},help:{title:{fr:"Aide",en:"Help"},url:{fr:"http://www.onf.ca/a-propos/faq/",en:"http://www.nfb.ca/about/faq/"},callback:null,preventDefault:false,target:"_blank",cssClass:null,tag:"help"},translate:[{title:"Français",url:"http://interactif.onf.ca/",callback:null,preventDefault:false,target:null,cssClass:null,tag:"lang-fr"},{title:"English",url:"http://interactive.nfb.ca/",callback:null,preventDefault:false,target:null,cssClass:null,tag:"lang-en"}]},z={target:"#onf-bot",opacity:0.8,opacityHover:1,recursive:false,ready:null,links:[{title:{fr:"Accueil",en:"Home"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"home"},{title:{fr:"À propos",en:"About"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"about"},{title:{fr:"Films reliés",en:"Related movies"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"related"},{title:{fr:"Équipe",en:"Credits"},url:null,callback:null,preventDefault:true,target:null,cssClass:"onf-bot-cont",tag:"credits"}],share:{title:{fr:"Partagez",en:"Share"},links:{facebook:"http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(document.location),twitter:"https://twitter.com/intent/tweet?text="+encodeURIComponent(document.title)+"&url="+encodeURIComponent(document.location),stumpleupon:"http://www.stumbleupon.com/submit?url="+encodeURIComponent(document.location)+"&title="+encodeURIComponent(document.title),digg:"http://digg.com/submit?phase=2&url="+encodeURIComponent(document.location)+"&bodytext="+encodeURIComponent(document.title),delicious:"http://www.delicious.com/post?v=2&url="+encodeURIComponent(document.location)+"&title="+encodeURIComponent(document.title)},callback:null},volume:{title:{fr:"Volume",en:"Volume"},callback:null},fullscreen:{title:{fr:"Plein écran",en:"Fullscreen"},callback:null}};function g(Y){return F.isFunction(Y)?Y.call(this,y):Y}function c(Y){return F.isPlainObject(Y)?Y[y]:g(Y)}function r(Z,Y){return !!Z?Z:Y}function I(Y){if(!!Y&&F.isFunction(Y.preventDefault)){Y.preventDefault()}return false}function n(af){var aa=F(this),ad=aa.data("link"),ac=aa.data("event"),ae=aa.data("target"),Y=ad.tag||aa.attr("data-tag"),ab=ae.data("opts"),Z=true;if(!!ad){if(F.isFunction(ad.callback)){ad.callback.call(aa,af,aa,ab,Y)}if(!!ad.preventDefault){Z=I(af)}}ae.triggerHandler(ac,[af,aa,ab,Y]);F.onf_nfb.stats.log("menu","click",Y,aa.index());return Z}function p(ac,aa){var Y=F(this),Z=Y.data("opts"),ab=g(Z.opacity);if(aa){ab=g(Z.opacityHover)}Y.stop(true,false).animate({opacity:ab},250)}function W(Y){p.call(this,Y,true)}function v(Y){p.call(this,Y,false)}function b(Z,ab,aa){var Y=F("<a></a>");Y.text(c(Z.title));if(!!Z.url){Y.attr("href",c(Z.url))}else{Y.attr("href","#")}Y.data("link",Z);Y.data("target",ab);Y.data("event",aa);if(!!Z.target){Y.attr("target",g(Z.target))}if(!!Z.cssClass){Y.attr("class",c(Z.cssClass))}Y.click(n);return Y}function E(){return document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.webkitFullScreen||document.msFullScreen}function P(Y){if(E()){return T(Y)}return N(Y)}function d(){var Y=document.documentElement,Z=Y.requestFullScreen||Y.webkitRequestFullScreen||Y.webkitEnterFullScreen||Y.mozRequestFullScreen||Y.msRequestFullScreen;return Z}function N(Z){var Y=d(),aa=false;if(Y!=l&&F.isFunction(Y)){Y.call(document.documentElement);aa=true}if(aa){F.event.trigger(H,[Z,this,true]);F.onf_nfb.stats.log("menu","fullscreen",true)}return I(Z)}function T(aa){var ab=false,Z=document,Y=Z.exitFullScreen||Z.cancelFullScreen||Z.webkitExitFullScreen||Z.webkitCancelFullScreen||Z.mozExitFullScreen||Z.mozCancelFullScreen||Z.msExitFullScreen||Z.msExitCancelScreen;if(Y!=l&&F.isFunction(Y)){Y.call(Z);ab=true}if(ab){F.event.trigger(H,[aa,this,false]);F.onf_nfb.stats.log("menu","fullscreen",false)}return I(aa)}function e(){return !!d()}function m(aa){var Y=F("#onf-volume"),Z=false;Y.toggleClass("muted");Z=Y.hasClass("muted");if(!!F.cookie){F.cookie("muted",Z?1:null,{expires:7,path:"/"})}F.event.trigger(k,[aa,Y,Z]);F.onf_nfb.stats.log("menu","mute",Z);return I(aa)}function x(Y,aa,Z){if(F.isFunction(aa)){if(!!Z&&F.isFunction(Z.on)){Z.on(Y,aa)}else{F(document).on(Y,aa)}}}function K(Y,ae,ab,ad,aa){var Z=g(this.minDelay);if(!aa||isNaN(aa)||aa<Z){aa=Z}function ac(){B.forEach(function(ah,ag){try{ah.log(Y,ae,ab,ad)}catch(af){console.error("[stats] "+ah.name+": "+af.message)}})}setTimeout(ac,aa)}function w(Y){B.push(Y)}function A(){var Y={name:"ONF-NFB logger",log:function(aa,ad,ab,ac){if(!!window.ntptEventTag&&F.isFunction(ntptEventTag)){var ae=aa+" > "+ad;if(!!ab){ae+=" > "+ab}if(!isNaN(ac)){ae+=" > "+ac}ntptEventTag("ev=interactif&ntpgi_interactive_page="+ae);return true}return false}},Z={name:"GA stats logger",log:function(aa,ad,ab,ac){if(!!window._gaq&&F.isFunction(_gaq.push)){_gaq.push(["_trackEvent",aa,ad,ab,ac]);return true}return false}};w(Y);w(Z)}A();function V(Z){var Y=F("#onf-top-search-txt").val();if(!!Y&&Y.length>0){F.event.trigger(o,[Z,this,Y]);F.onf_nfb.stats.log("menu","search",Y);setTimeout(function(){document.location=X+encodeURIComponent(Y)},F.onf_nfb.stats.minDelay)}return I(Z)}function Q(ac,Z){var aa=F("#onf-top-search-pnl"),ab=F("#onf-top-search-lbl"),Y=aa.find("input[type=text]").eq(0);aa[Z?"fadeIn":"fadeOut"].call(aa,400);ab[Z?"fadeOut":"fadeIn"].call(ab,400);Y[Z?"focus":"blur"].call(Y);return I(ac)}function L(Y){return Q.call(this,Y,true)}function a(Y){return Q.call(this,Y,false)}function G(Y){switch(Y.which){case 27:a.call(this);break;case 13:V();break}return true}function i(aj){var Z=F.extend((!!aj&&!!aj.recursive?true:{}),Z,t,aj),ah=F(Z.target),af=Math.abs(g(Z.opacity)-g(Z.opacityHover))>0,ad=F('<a id="onf-top-logo"></a>'),ae=F('<span id="onf-top-search"></span>'),ag=F('<a href="#" id="onf-top-search-lbl"></a>'),ab=F('<div id="onf-top-search-pnl"></div>'),ac=F('<input id="onf-top-search-txt" type="text" />'),Y=F('<input id="onf-top-search-btn" type="button" value="" />'),ai=F('<div id="onf-top-right"></span>'),aa=F('<div id="onf-top-wrap"></div>');if(!ah||!ah.length){console.error("[top] the target "+Z.target+" could not be found.");return}ad.attr("href",s);ad.click(function(ak){F.event.trigger(h,[ak,this,Z,"logo"]);F.onf_nfb.stats.log("menu","click","logo");return true});aa.append(ad);if(!!Z.links&&!!Z.links.length){Z.links.forEach(function(al,ak){aa.append(b(al,ah,h))})}if(!!Z.search){ag.text(c(Z.search.title));ag.click(L);ac.attr("placeholder",c(Z.search.title));ac.keydown(G);Y.click(V);ab.append(ac).append(Y);ae.append(ag).append(ab);aa.append(ae);F(document.documentElement).mousedown(function(ak){if(ak.target.nodeName!="INPUT"){a(ak)}return true});x(o,Z.search.callback)}if(!!Z.help){ai.append(b(Z.help,ah,U))}if(!!Z.translate&&!!Z.translate.length){Z.translate.forEach(function(al,ak){if(al.tag!="lang-"+y){ai.append(b(al,ah,D))}})}aa.append(ai);ah.empty().append(aa);ah.data("opts",Z);if(af){ah.hover(W,v);v.call(ah)}else{ah.off("mouseenter",W).off("mouseleave",v)}if(F.isFunction(Z.ready)){Z.ready.call(ah,Z)}}function u(ad,ac){var ab=F("#onf-bot-share"),Y=M,aa=ab.find(".onf-social").length,Z=Y+(20*aa);if(ac){Y=Z}ab.stop(false,false).animate({width:Y},Z*2);return I(ad)}function f(Y){return u.call(this,Y,true)}function q(Y){return u.call(this,Y,false)}function j(ak){var Y=F.extend((!!ak&&!!ak.recursive?true:{}),Y,z,ak),af=F(Y.target),ac=Math.abs(g(Y.opacity)-g(Y.opacityHover))>0,aa=F('<div id="onf-bot-wrap"></div>'),ai=F('<span id="onf-bot-right"></span>'),ag=F('<span id="onf-bot-share"></span>'),ae=F('<span id="onf-share-opts"></span>'),Z=F('<a href="#" id="onf-volume"></a>'),ah=F('<a href="#" id="onf-fullscreen"></a>');if(!af||!af.length){console.error("[bot] the target "+Y.target+" could not be found.");return}if(!!Y.links&&!!Y.links.length){Y.links.forEach(function(am,al){aa.append(b(am,af,R))})}if(!!Y.share){ag.append(F("<span>"+c(Y.share.title)+"</span>"));for(var ad in Y.share.links){if(Y.share.links.hasOwnProperty(ad)){var ab=Y.share.links[ad],aj=F("<a></a>");aj.attr("href",g(ab));aj.attr("data-tag",ad);aj.attr("id","onf-"+ad);aj.attr("class","onf-social");aj.attr("target","_blank");aj.click(function(al){F.event.trigger(S,[al,this,ad]);F.onf_nfb.stats.log("menu","share",ad);return true});ae.append(aj)}}ag.mouseenter(f);af.mouseleave(q);ag.append(ae);ai.append(ag);x(S,Y.share.callback,ae)}if(!!Y.volume&&!C.mobile){Z.text(c(Y.volume.title));Z.click(m);if(!!F.cookie&&!!F.cookie("muted")){Z.addClass("muted")}ai.append(Z);x(k,Y.volume.callback,Z)}if(!!Y.fullscreen&&e()){ah.text(c(Y.fullscreen.title));ah.click(P);ai.append(ah);x(H,Y.fullscreen.callback,ah)}aa.append(ai);af.empty().append(aa);af.data("opts",Y);if(ac){af.hover(W,v);v.call(af)}else{af.off("mouseenter",W).off("mouseleave",v)}if(F.isFunction(Y.ready)){Y.ready.call(af,Y)}}F.onf_nfb=F.extend(true,F.onf_nfb,{stats:{minDelay:80,log:K,add:w},menu:{top:i,bot:j},events:{namespace:J,topclick:h,help:U,lang:D,search:o,botclick:R,share:S,volume:k,fullscreen:H}})})(jQuery);