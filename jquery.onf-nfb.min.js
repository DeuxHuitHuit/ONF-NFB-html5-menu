/**
 * ONF-NFB Menu Minified Behavior jQuery script
 * 
 * @author: DeuxHuitHuit
 * 
 * @version: 1.0.0.1
 * 
 * @date: 2014-05-05
 * 
 * Compiled with uglifyjs http://marijnhaverbeke.nl/uglifyjs
 * 
**/
!function(a,b){function u(b){return a.isFunction(b)?b.call(this,c):b}function v(b){return a.isPlainObject(b)?b[c]:u(b)}function w(a,b){return a?a:b}function x(b){return b&&a.isFunction(b.preventDefault)&&b.preventDefault(),!1}function y(b){var c=a(this),d=c.data("link"),e=c.data("event"),f=c.data("target"),g=d.tag||c.attr("data-tag"),h=f.data("opts"),i=!0;return d&&(a.isFunction(d.callback)&&d.callback.call(c,b,c,h,g),d.preventDefault&&(i=x(b))),f.triggerHandler(e,[b,c,h,g]),a.onf_nfb.stats.log("menu","click",g,c.index()),i}function z(b,c){var d=a(this),e=d.data("opts"),f=u(e.opacity);c&&(f=u(e.opacityHover)),d.stop(!0,!1).animate({opacity:f},250)}function A(a){z.call(this,a,!0)}function B(a){z.call(this,a,!1)}function C(b,c,d){var e=a("<a></a>");return e.text(v(b.title)),b.url?e.attr("href",v(b.url)):e.attr("href","#"),e.data("link",b),e.data("target",c),e.data("event",d),b.target&&e.attr("target",u(b.target)),b.cssClass&&e.attr("class",v(b.cssClass)),e.click(y),e}function D(){return document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.webkitFullScreen||document.msFullScreen}function E(a){return D()?H(a):G(a)}function F(){var a=document.documentElement,b=a.requestFullScreen||a.webkitRequestFullScreen||a.webkitEnterFullScreen||a.mozRequestFullScreen||a.msRequestFullScreen;return b}function G(c){var d=F(),e=!1;return d!=b&&a.isFunction(d)&&(d.call(document.documentElement),e=!0),e&&(a.event.trigger(o,[c,this,!0]),a.onf_nfb.stats.log("menu","fullscreen",!0)),x(c)}function H(c){var d=!1,e=document,f=e.exitFullScreen||e.cancelFullScreen||e.webkitExitFullScreen||e.webkitCancelFullScreen||e.mozExitFullScreen||e.mozCancelFullScreen||e.msExitFullScreen||e.msExitCancelScreen;return f!=b&&a.isFunction(f)&&(f.call(e),d=!0),d&&(a.event.trigger(o,[c,this,!1]),a.onf_nfb.stats.log("menu","fullscreen",!1)),x(c)}function I(){return!!F()}function J(b){var c=a("#onf-volume"),d=!1;return c.toggleClass("muted"),d=c.hasClass("muted"),a.cookie&&a.cookie("muted",d?1:null,{expires:7,path:"/"}),a.event.trigger(n,[b,c,d]),a.onf_nfb.stats.log("menu","mute",d),x(b)}function K(b,c,d){a.isFunction(c)&&(d&&a.isFunction(d.on)?d.on(b,c):a(document).on(b,c))}function L(a,b,c,d,e){function g(){p.forEach(function(e){try{e.log(a,b,c,d)}catch(g){console.error("[stats] "+e.name+": "+g.message)}})}var f=u(this.minDelay);(!e||isNaN(e)||f>e)&&(e=f),setTimeout(g,e)}function M(a){p.push(a)}function N(){var b={name:"ONF-NFB logger",log:function(b,c,d,e){if(window.ntptEventTag&&a.isFunction(ntptEventTag)){var f=b+" > "+c;return d&&(f+=" > "+d),isNaN(e)||(f+=" > "+e),ntptEventTag("ev=interactif&ntpgi_interactive_page="+f),!0}return!1}},c={name:"GA stats logger",log:function(b,c,d,e){return window._gaq&&a.isFunction(_gaq.push)?(_gaq.push(["_trackEvent",b,c,d,e]),!0):!1}};M(b),M(c)}function O(b){var c=a("#onf-top-search-txt").val();return c&&c.length>0&&(a.event.trigger(k,[b,this,c]),a.onf_nfb.stats.log("menu","search",c),setTimeout(function(){document.location=e+encodeURIComponent(c)},a.onf_nfb.stats.minDelay)),x(b)}function P(b,c){var d=a("#onf-top-search-pnl"),e=a("#onf-top-search-lbl"),f=d.find("input[type=text]").eq(0);return d[c?"fadeIn":"fadeOut"].call(d,400),e[c?"fadeOut":"fadeIn"].call(e,400),f[c?"focus":"blur"].call(f),x(b)}function Q(a){return P.call(this,a,!0)}function R(a){return P.call(this,a,!1)}function S(a){switch(a.which){case 27:R.call(this);break;case 13:O()}return!0}function T(b){var e=a.extend(b&&b.recursive?!0:{},e,q,b),f=a(e.target),g=Math.abs(u(e.opacity)-u(e.opacityHover))>0,l=a('<a id="onf-top-logo"></a>'),m=a('<span id="onf-top-search"></span>'),n=a('<a href="#" id="onf-top-search-lbl"></a>'),o=a('<div id="onf-top-search-pnl"></div>'),p=a('<input id="onf-top-search-txt" type="text" />'),r=a('<input id="onf-top-search-btn" type="button" value="" />'),s=a('<div id="onf-top-right"></span>'),t=a('<div id="onf-top-wrap"></div>');return f&&f.length?(l.attr("href",d),l.click(function(b){return a.event.trigger(h,[b,this,e,"logo"]),a.onf_nfb.stats.log("menu","click","logo"),!0}),t.append(l),e.links&&e.links.length&&e.links.forEach(function(a){t.append(C(a,f,h))}),e.search&&(n.text(v(e.search.title)),n.click(Q),p.attr("placeholder",v(e.search.title)),p.keydown(S),r.click(O),o.append(p).append(r),m.append(n).append(o),t.append(m),a(document.documentElement).mousedown(function(a){return"INPUT"!=a.target.nodeName&&R(a),!0}),K(k,e.search.callback)),e.help&&s.append(C(e.help,f,i)),e.translate&&e.translate.length&&e.translate.forEach(function(a){a.tag!="lang-"+c&&s.append(C(a,f,j))}),t.append(s),f.empty().append(t),f.data("opts",e),g?(f.hover(A,B),B.call(f)):f.off("mouseenter",A).off("mouseleave",B),a.isFunction(e.ready)&&e.ready.call(f,e),void 0):(console.error("[top] the target "+e.target+" could not be found."),void 0)}function U(b,c){var d=a("#onf-bot-share"),e=f,g=d.find(".onf-social").length,h=e+20*g;return c&&(e=h),d.stop(!1,!1).animate({width:e},2*h),x(b)}function V(a){return U.call(this,a,!0)}function W(a){return U.call(this,a,!1)}function X(b){var c=a.extend(b&&b.recursive?!0:{},c,r,b),d=a(c.target),e=Math.abs(u(c.opacity)-u(c.opacityHover))>0,f=a('<div id="onf-bot-wrap"></div>'),g=a('<span id="onf-bot-right"></span>'),h=a('<span id="onf-bot-share"></span>'),i=a('<span id="onf-share-opts"></span>'),j=a('<a href="#" id="onf-volume"></a>'),k=a('<a href="#" id="onf-fullscreen"></a>'),p=null;if(!d||!d.length)return console.error("[bot] the target "+c.target+" could not be found."),void 0;if(c.links&&c.links.length&&c.links.forEach(function(a){f.append(C(a,d,l))}),c.share){h.append(a("<span>"+v(c.share.title)+"</span>"));for(p in c.share.links)if(c.share.links.hasOwnProperty(p)){var q=c.share.links[p],s=a("<a></a>");s.attr("href",u(q)),s.attr("data-tag",p),s.attr("id","onf-"+p),s.attr("class","onf-social"),s.attr("target","_blank"),s.click(function(b){return a.event.trigger(m,[b,this,p]),a.onf_nfb.stats.log("menu","share",p),!0}),i.append(s)}h.mouseenter(V),d.mouseleave(W),h.append(i),g.append(h),K(m,c.share.callback,i)}c.volume&&!t.mobile&&(j.text(v(c.volume.title)),j.click(J),a.cookie&&a.cookie("muted")&&j.addClass("muted"),g.append(j),K(n,c.volume.callback,j)),c.fullscreen&&I()&&(k.text(v(c.fullscreen.title)),k.click(E),g.append(k),K(o,c.fullscreen.callback,k)),f.append(g),d.empty().append(f),d.data("opts",c),e?(d.hover(A,B),B.call(d)):d.off("mouseenter",A).off("mouseleave",B),a.isFunction(c.ready)&&c.ready.call(d,c)}window.console||(window.console={},window.console.log=window.console.warn=window.console.error=window.console.info=a.noop),Array.prototype.forEach||(Array.prototype.forEach=function(a){var b=this.length,c=0,d=arguments[1];if("function"!=typeof a)throw new TypeError("First parameter must be a function");for(c=0;b>c;c++)c in this&&a.call(d,this[c],c,this)});var c=w(a("html").attr("lang"),"en"),d="fr"==c?"http://www.onf.ca":"http://www.nfb.ca",e="http://search.nfb.ca/search?entqr=0&output=xml_no_dtd&sort=date%3AD%3AL%3Ad1&client=beta_onfb&ud=1&oe=UTF-8&ie=UTF-8&proxystylesheet=beta_onfb&proxyreload=1&hl="+c+"&lr=lang_"+c+"&site=beta_onfb&q=",f=55,g="onf-nfb",h="topclick.onf-nfb",i="help.onf-nfb",j="lang.onf-nfb",k="search.onf-nfb",l="botclick.onf-nfb",m="share.onf-nfb",n="volume.onf-nfb",o="fullscreen.onf-nfb",p=[],q={target:"#onf-top",opacity:.8,opacityHover:1,recursive:!1,ready:null,links:[{title:{fr:"Explorer",en:"Explore"},url:{fr:"http://www.onf.ca/explorer-tous-les-films/",en:"http://www.nfb.ca/explore-all-films/"},callback:null,preventDefault:!1,target:null,cssClass:null,tag:"explore"},{title:{fr:"S\xe9lections",en:"Playlists"},url:{fr:"http://onf.ca/selections/",en:"http://www.nfb.ca/playlists/"},callback:null,preventDefault:!1,target:null,cssClass:null,tag:"playlist"},{title:{fr:"Cha\xeenes",en:"Channels"},url:{fr:"http://www.onf.ca/chaines/",en:"http://www.nfb.ca/channels/"},callback:null,preventDefault:!1,target:null,cssClass:null,tag:"channels"},{title:{fr:"Blogue",en:"Blog"},url:{fr:"http://blogue.onf.ca/",en:"http://blog.nfb.ca/"},callback:null,preventDefault:!1,target:null,cssClass:null,tag:"blog"},{title:{fr:"Interactif",en:"Interactive"},url:{fr:"http://www.onf.ca/interactif/",en:"http://www.nfb.ca/interactive/"},callback:null,preventDefault:!1,target:null,cssClass:"active",tag:"interative"}],search:{title:{fr:"Recherche",en:"Search"},callback:null},help:{title:{fr:"Aide",en:"Help"},url:{fr:"http://www.onf.ca/a-propos/faq/",en:"http://www.nfb.ca/about/faq/"},callback:null,preventDefault:!1,target:"_blank",cssClass:null,tag:"help"},translate:[{title:"Fran\xe7ais",url:"http://interactif.onf.ca/",callback:null,preventDefault:!1,target:null,cssClass:null,tag:"lang-fr"},{title:"English",url:"http://interactive.nfb.ca/",callback:null,preventDefault:!1,target:null,cssClass:null,tag:"lang-en"}]},r={target:"#onf-bot",opacity:.8,opacityHover:1,recursive:!1,ready:null,links:[{title:{fr:"Accueil",en:"Home"},url:null,callback:null,preventDefault:!0,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"home"},{title:{fr:"\xc0 propos",en:"About"},url:null,callback:null,preventDefault:!0,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"about"},{title:{fr:"Films reli\xe9s",en:"Related movies"},url:null,callback:null,preventDefault:!0,target:null,cssClass:"onf-bot-cont onf-bot-border",tag:"related"},{title:{fr:"\xc9quipe",en:"Credits"},url:null,callback:null,preventDefault:!0,target:null,cssClass:"onf-bot-cont",tag:"credits"}],share:{title:{fr:"Partagez",en:"Share"},links:{facebook:"http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(document.location),twitter:"https://twitter.com/intent/tweet?text="+encodeURIComponent(document.title)+"&url="+encodeURIComponent(document.location),stumpleupon:"http://www.stumbleupon.com/submit?url="+encodeURIComponent(document.location)+"&title="+encodeURIComponent(document.title),digg:"http://digg.com/submit?phase=2&url="+encodeURIComponent(document.location)+"&bodytext="+encodeURIComponent(document.title),delicious:"http://www.delicious.com/post?v=2&url="+encodeURIComponent(document.location)+"&title="+encodeURIComponent(document.title)},callback:null},volume:{title:{fr:"Volume",en:"Volume"},callback:null},fullscreen:{title:{fr:"Plein \xe9cran",en:"Fullscreen"},callback:null}},s=window.navigator&&navigator.userAgent?navigator.userAgent:!1,t={unsupported:!a.browser||!!(a.browser.msie&&parseInt(a.browser.version,10)<9),ipad:!!s&&!!s.match(/iPad/i),iphone:!!s&&!!s.match(/iPhone/i)||!!s.match(/iPod/i),android:!!s&&!!s.match(/Android/i)};t.ios=t.ipad||t.iphone,t.mobile=t.ios||t.android||!!s&&(s.match(/mobile/i)||s.match(/phone/i))||!!document.location.toString().match(/.+(\?|#)mobile$/i),N(),a.onf_nfb=a.extend(!0,a.onf_nfb,{stats:{minDelay:80,log:L,add:M},menu:{top:T,bot:X},defaults:{top:q,bot:r},events:{namespace:g,topclick:h,help:i,lang:j,search:k,botclick:l,share:m,volume:n,fullscreen:o}})}(jQuery);
